{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nimport React, { useEffect, useMemo } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Route, Switch } from 'react-router-dom';\nimport WithPermissions from '../auth/WithPermissions';\nimport { registerResource, unregisterResource } from '../actions';\nvar defaultOptions = {};\n\nvar ResourceRegister = function (_a) {\n  var name = _a.name,\n      list = _a.list,\n      create = _a.create,\n      edit = _a.edit,\n      show = _a.show,\n      icon = _a.icon,\n      _b = _a.options,\n      options = _b === void 0 ? defaultOptions : _b;\n  var dispatch = useDispatch();\n  useEffect(function () {\n    dispatch(registerResource({\n      name: name,\n      options: options,\n      hasList: !!list,\n      hasEdit: !!edit,\n      hasShow: !!show,\n      hasCreate: !!create,\n      icon: icon\n    }));\n    return function () {\n      return dispatch(unregisterResource(name));\n    };\n  }, [dispatch, name, create, edit, icon, list, show, options]);\n  return null;\n};\n\nvar ResourceRoutes = function (_a) {\n  var name = _a.name,\n      match = _a.match,\n      list = _a.list,\n      create = _a.create,\n      edit = _a.edit,\n      show = _a.show,\n      _b = _a.options,\n      options = _b === void 0 ? defaultOptions : _b;\n  var isRegistered = useSelector(function (state) {\n    return state.admin.resources[name] ? true : false;\n  });\n  var basePath = match ? match.path : ''; // match tends to change even on the same route ; using memo to avoid an extra render\n\n  return useMemo(function () {\n    // if the registration hasn't finished, no need to render\n    if (!isRegistered) {\n      return null;\n    }\n\n    var props = {\n      resource: name,\n      options: options,\n      hasList: !!list,\n      hasEdit: !!edit,\n      hasShow: !!show,\n      hasCreate: !!create\n    };\n    return React.createElement(Switch, null, create && React.createElement(Route, {\n      path: basePath + \"/create\",\n      render: function (routeProps) {\n        return React.createElement(WithPermissions, __assign({\n          component: create,\n          basePath: basePath\n        }, routeProps, props));\n      }\n    }), show && React.createElement(Route, {\n      path: basePath + \"/:id/show\",\n      render: function (routeProps) {\n        return React.createElement(WithPermissions, __assign({\n          component: show,\n          basePath: basePath,\n          id: decodeURIComponent(routeProps.match.params.id)\n        }, routeProps, props));\n      }\n    }), edit && React.createElement(Route, {\n      path: basePath + \"/:id\",\n      render: function (routeProps) {\n        return React.createElement(WithPermissions, __assign({\n          component: edit,\n          basePath: basePath,\n          id: decodeURIComponent(routeProps.match.params.id)\n        }, routeProps, props));\n      }\n    }), list && React.createElement(Route, {\n      path: \"\" + basePath,\n      render: function (routeProps) {\n        return React.createElement(WithPermissions, __assign({\n          component: list,\n          basePath: basePath\n        }, routeProps, props));\n      }\n    }));\n  }, [basePath, name, create, edit, list, show, options, isRegistered]); // eslint-disable-line react-hooks/exhaustive-deps\n};\n\nvar Resource = function (_a) {\n  var _b = _a.intent,\n      intent = _b === void 0 ? 'route' : _b,\n      props = __rest(_a, [\"intent\"]);\n\n  return intent === 'registration' ? React.createElement(ResourceRegister, __assign({}, props)) : React.createElement(ResourceRoutes, __assign({}, props));\n};\n\nexport default Resource;","map":null,"metadata":{},"sourceType":"module"}